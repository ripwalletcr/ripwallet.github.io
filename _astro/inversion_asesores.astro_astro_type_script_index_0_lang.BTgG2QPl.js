import{E as U,a as C,C as M}from"./jspdf.plugin.autotable.BcsPjRKA.js";function $(){const z=[{display:"initialAmountFormatted",hidden:"initialAmount"},{display:"monthlyContributionFormatted",hidden:"monthlyContribution"}],T=["termYears","annualReturn","currency","investmentType","commissionRate","commissionFrequency","commissionBase"],e={};z.forEach(t=>{const n=document.getElementById(t.display),l=document.getElementById(t.hidden);!n||!l||(e[t.hidden]=l,n.addEventListener("input",u=>{const c=u.target;let s=c.value.replace(/,/g,"");isNaN(Number(s))&&(s="0"),l.value=s,s!==""&&(c.value=Number(s).toLocaleString("en-US")),g()}))}),T.forEach(t=>{const n=document.getElementById(t);n&&(e[t]=n,n.addEventListener("input",g))});let d=null,r=[];function a(t){const n=e.currency?.value||"USD";return(n==="CRC"?"¢":n==="USD"?"$":"€")+new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t)}function L(){const t=document.getElementById("growthChart");if(!t)return;const n=t.getContext("2d");n&&(d=new M(n,{type:"line",data:{labels:[],datasets:[{label:"Aportes",data:[],borderColor:"#e2e8f0",borderWidth:2,fill:!1,pointRadius:0,tension:.3,borderDash:[5,5]},{label:"Total",data:[],borderColor:"#17a34a",borderWidth:3,fill:!0,pointRadius:0,tension:.3,backgroundColor:"rgba(23, 163, 74, 0.03)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{ticks:{font:{family:"Poppins",size:9}},grid:{color:"#f1f5f9"}},x:{ticks:{font:{family:"Poppins",size:9}},grid:{display:!1}}}}}))}function g(){const t=parseFloat(e.initialAmount?.value)||0,n=parseFloat(e.monthlyContribution?.value)||0,l=parseFloat(e.termYears?.value)||0,u=parseFloat(e.annualReturn?.value)/100||0,c=e.investmentType?.value||"compound",s=parseFloat(e.commissionRate?.value)/100||0,f=e.commissionBase?.value||"global";if(l<=0)return;let o=t,m=t,x=0,h=0;r=[];let I=[],E=[],R=[];const N=l*12,A=u/12;let b=0,v=0;for(let i=1;i<=N;i++){let p=0;c==="simple"?p=m*A:p=o*A,o+=p,b+=p,x+=p,o+=n,m+=n;let y=0;f==="global"?y=o*(s/12):y=m*(s/12),o-=y,v+=y,h+=y,i%12===0&&(r.push({year:i/12,contributed:m,earnings:b,commission:v,balance:o}),I.push(`Año ${i/12}`),E.push(o),R.push(m),b=0,v=0)}const D=document.getElementById("finalCapitalDisplay"),B=document.getElementById("netEarningsDisplay"),w=document.getElementById("totalContributionsDisplay"),S=document.getElementById("totalCommissionsDisplay"),P=document.getElementById("investmentTableBody");D&&(D.textContent=a(o)),B&&(B.textContent=a(x-h)),w&&(w.textContent=a(m)),S&&(S.textContent=a(h)),d&&(d.data.labels=I,d.data.datasets[0].data=R,d.data.datasets[1].data=E,d.update()),P&&(P.innerHTML=r.map(i=>`
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="px-8 py-5 font-bold text-gray-900">${i.year}</td>
            <td class="px-8 py-5 text-gray-500">${a(i.contributed)}</td>
            <td class="px-8 py-5 text-green-600">+ ${a(i.earnings)}</td>
            <td class="px-8 py-5 text-red-500">- ${a(i.commission)}</td>
            <td class="px-8 py-5 font-bold text-gray-900">${a(i.balance)}</td>
          </tr>
        `).join(""))}async function Y(){const t=new U("p","mm","a4"),n=e.currency?.value||"USD";t.setFont("helvetica","bold"),t.setFontSize(22),t.text("Proyección de Inversión",20,25),t.setFontSize(10),t.setFont("helvetica","normal"),t.text(`RIP Wallet | www.ripwallet.co - ${new Date().toLocaleDateString()}`,20,32);const l=[["Moneda",n],["Inversión Inicial",a(parseFloat(e.initialAmount.value))],["Aporte Mensual",a(parseFloat(e.monthlyContribution.value))],["Plazo",`${e.termYears.value} años`],["Retorno Anual",`${e.annualReturn.value}%`],["Comisión Anual",`${e.commissionRate.value}%`]];t.setFontSize(13),t.setFont("helvetica","bold"),t.text("Configuración de la Inversión",20,45),C(t,{startY:50,body:l,theme:"plain",styles:{fontSize:9,cellPadding:2}});let u=r.length?r[r.length-1].balance:0;const c=t.lastAutoTable.finalY+10;t.setFont("helvetica","bold"),t.text("Resumen Final",20,c);const s=[["Capital Final",a(u)],["Total Aportado",a(parseFloat(e.initialAmount.value)+parseFloat(e.monthlyContribution.value)*12*e.termYears.value)]];C(t,{startY:c+5,body:s,theme:"grid",styles:{fontSize:10}});const f=document.getElementById("growthChart");if(f){await new Promise(requestAnimationFrame);const o=f.toDataURL("image/png",1);t.addPage(),t.setFontSize(14),t.text("Gráfico de Crecimiento",20,25),t.addImage(o,"PNG",15,35,180,90)}r.length&&(t.addPage(),t.setFontSize(14),t.text("Detalle Anual",20,25),C(t,{startY:30,head:[["Año","Aportado","Rendimiento","Comisión","Saldo"]],body:r.map(o=>[o.year,a(o.contributed),a(o.earnings),a(o.commission),a(o.balance)]),styles:{fontSize:9},theme:"striped"})),t.save(`RIP-Wallet-Inversion-${Date.now()}.pdf`)}const F=document.getElementById("downloadPdf");F&&F.addEventListener("click",Y),L(),g()}$();document.addEventListener("astro:page-load",$);
