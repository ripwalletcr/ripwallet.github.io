import{E as T,a as g,C as $}from"./jspdf.plugin.autotable.BcsPjRKA.js";function w(){const R=[{display:"initialAmountFormatted",hidden:"initialAmount"},{display:"monthlyContributionFormatted",hidden:"monthlyContribution"}],S=["termYears","annualReturn","currency","investmentType"],n={};R.forEach(t=>{const e=document.getElementById(t.display),s=document.getElementById(t.hidden);!e||!s||(n[t.hidden]=s,e.addEventListener("input",m=>{const c=m.target;let o=c.value.replace(/,/g,"");isNaN(Number(o))&&(o="0"),s.value=o,o!==""&&(c.value=Number(o).toLocaleString("en-US")),y()}))}),S.forEach(t=>{const e=document.getElementById(t);e&&(n[t]=e,e.addEventListener("input",y))});let u=null,r=[];function a(t){const e=n.currency?.value||"USD";return(e==="CRC"?"¢":e==="USD"?"$":"€")+new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t)}function B(){const t=document.getElementById("growthChart");if(!t)return;const e=t.getContext("2d");e&&(u=new $(e,{type:"line",data:{labels:[],datasets:[{label:"Aportes",data:[],borderColor:"#e2e8f0",borderWidth:2,fill:!1,pointRadius:0,tension:.3,borderDash:[5,5]},{label:"Total",data:[],borderColor:"#17a34a",borderWidth:3,fill:!0,pointRadius:0,tension:.3,backgroundColor:"rgba(23, 163, 74, 0.03)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{ticks:{font:{family:"Poppins",size:9}},grid:{color:"#f1f5f9"}},x:{ticks:{font:{family:"Poppins",size:9}},grid:{display:!1}}}}}))}function y(){const t=parseFloat(n.initialAmount?.value)||0,e=parseFloat(n.monthlyContribution?.value)||0,s=parseFloat(n.termYears?.value)||0,m=parseFloat(n.annualReturn?.value)/100||0,c=n.investmentType?.value||"compound";if(s<=0)return;let o=t,d=t,l=0;r=[];let b=[],v=[],C=[];const z=s*12,F=m/12;let f=0;for(let i=1;i<=z;i++){let p=0;c==="simple"?p=d*F:p=o*F,o+=p,f+=p,l+=p,o+=e,d+=e,i%12===0&&(r.push({year:i/12,contributed:d,earnings:f,balance:o}),b.push(`Año ${i/12}`),v.push(o),C.push(d),f=0)}const E=document.getElementById("finalCapitalDisplay"),I=document.getElementById("netEarningsDisplay"),x=document.getElementById("totalContributionsDisplay"),D=document.getElementById("totalEarningsDisplay"),A=document.getElementById("investmentTableBody");E&&(E.textContent=a(o)),I&&(I.textContent=a(l)),x&&(x.textContent=a(d)),D&&(D.textContent=a(l)),u&&(u.data.labels=b,u.data.datasets[0].data=C,u.data.datasets[1].data=v,u.update()),A&&(A.innerHTML=r.map(i=>`
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="px-8 py-5 font-bold text-gray-900">${i.year}</td>
            <td class="px-8 py-5 text-gray-500">${a(i.contributed)}</td>
            <td class="px-8 py-5 text-green-600">+ ${a(i.earnings)}</td>
            <td class="px-8 py-5 font-bold text-gray-900">${a(i.balance)}</td>
          </tr>
        `).join(""))}async function P(){const t=new T("p","mm","a4"),e=n.currency?.value||"USD";t.setFont("helvetica","bold"),t.setFontSize(22),t.text("Proyección de Inversión",20,25),t.setFontSize(10),t.setFont("helvetica","normal"),t.text(`RIP Wallet | www.ripwallet.co - ${new Date().toLocaleDateString()}`,20,32);const s=[["Moneda",e],["Inversión Inicial",a(parseFloat(n.initialAmount.value))],["Aporte Mensual",a(parseFloat(n.monthlyContribution.value))],["Plazo",`${n.termYears.value} años`],["Retorno Anual",`${n.annualReturn.value}%`]];t.setFontSize(13),t.setFont("helvetica","bold"),t.text("Configuración de la Inversión",20,45),g(t,{startY:50,body:s,theme:"plain",styles:{fontSize:9,cellPadding:2}});let m=r.length?r[r.length-1].balance:0;const c=t.lastAutoTable.finalY+10;t.setFont("helvetica","bold"),t.text("Resumen Final",20,c);const o=[["Capital Final",a(m)],["Total Aportado",a(parseFloat(n.initialAmount.value)+parseFloat(n.monthlyContribution.value)*12*n.termYears.value)]];g(t,{startY:c+5,body:o,theme:"grid",styles:{fontSize:10}});const d=document.getElementById("growthChart");if(d){await new Promise(requestAnimationFrame);const l=d.toDataURL("image/png",1);t.addPage(),t.setFontSize(14),t.text("Gráfico de Crecimiento",20,25),t.addImage(l,"PNG",15,35,180,90)}r.length&&(t.addPage(),t.setFontSize(14),t.text("Detalle Anual",20,25),g(t,{startY:30,head:[["Año","Aportado","Rendimiento","Saldo"]],body:r.map(l=>[l.year,a(l.contributed),a(l.earnings),a(l.balance)]),styles:{fontSize:9},theme:"striped"})),t.save(`RIP-Wallet-Inversion-${Date.now()}.pdf`)}const h=document.getElementById("downloadPdf");h&&h.addEventListener("click",P),B(),y()}w();document.addEventListener("astro:page-load",w);
